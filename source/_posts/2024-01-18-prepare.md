---
title: 2024省选准备
subtitle: 单纯是以前的blog有点长新开一篇
layout: post
show: true
top: false
tags: 
- 日志
- 杂题
---

# 省选准备?

### P3726 [AH2017/HNOI2017] 抛硬币

要求

$$
\sum_i \sum_j [j<i] \binom{a}{i}\binom{b}{j}
$$

这就不会了,然而这是双射题,考虑$a=b$的时候赢的翻转能映输的,就只需要求平局的$\sum_i \binom{a}{i}^2$是经典问题.

现在$a>b$,设实际各证明$x,y$次,则$a$输/平的翻转都会变成赢($x\le y,a-x>b-y$),而问题就是A赢的可能仍然是赢,这种情况要求$a-x>b-y,x>y$,于是$x-y\in [0,a-b]$,而$a-b$很小,枚举个差,就是$\sum_d \sum_i \binom{a}{i+d}\binom{b}{i}=\sum_d \sum_i \binom{a}{i+d}\binom{b}{b-i}=\sum_d \binom{a+b}{b+d}$暴力算就行了.

最后你需要用exlucas算组合数

### P5279 [ZJOI2019] 麻将

dpofdp,先考虑如何判定是否胡牌,那么顺子这种性质肯定是扫值域,从小到大,设$f_{i,j,0/1}$表示前$i$种牌,形成$j$个$i,i-1$的对,是否已经出现刻字,转移显然,可以对着转移建自动机.

发现节点并不对,$S\approx 2000$个

然后求期望可以累加前缀$1\ldots i$加入之后还没胡的概率,于是$f_{i,j,k}$表示前$i$种牌,一共加入了$j$张牌,走到自动机的节点$k$的期望步数.

转移是枚举当前种牌加了多少张,复杂度是$n^2S$的.

### P3307 [SDOI2013] 项链

先数珠子有几种,正三棱柱的置换包括3种,横着转一/二下和左右翻转,只要数互质数对个数,莫反板子.

然后数项链是模板ploya吧?

### P4916 [MtOI2018] 魔力环

先上一套burnside,现在变成要求对每个$d$,设$l=gcd(d,n)$,求$f_l$表示长$l$的环(不可旋转),有$\dfrac{mn}{l}$个黑色珠子,不能连续出$k$个黑色的方案数.

先把白色放好开始插入黑色,枚举插入的空隙数,设黑色个数为$b$,得到

$$
\sum_i \binom{l-b}{i}g(b,i)
$$
于是求$g(n,c)$表示把$n$个不区分的球分成$c$个区分的盒子每份大小不超过$k$的方案数,于是

$$
g(n,c)=[x^n](\dfrac{1-x^{k+1}}{1-x})^c=(1-x^{k+1})^c(1-x)^{-c}=(\sum_i \binom{c}{i}x^{ik+i})(\sum_i \binom{c+i-1}{i}x^i)
$$

于是可以$\dfrac{n}{k}$算一项,而枚举插入的空隙数是$O(k)$的,所以算一次是$O(m)$,于是算所有$f$的复杂度是关于$n$约数和线性,而约数和最大是$n\log n$的(根号为界分开分析),于是总复杂度是单log的.

### [ARC120F] Wine Thief

考虑对每个元素计算贡献,要算挖去一个区间后两边选$k-1$个元素的方案数.是两边的方案卷起来,不可做.

考虑设从$n$个中选$i$个且满足限制的方案数为$f_{n,i}$,从$n$个中选$i$个且第$j$个强制选的方案数为$g_{n,i,j}$,则对于$i\in [D,n-D+1]$,$g_{n,i,j}$就是先选一个$j$,然后要求$[j-D+1,j+D-1]$这块不能选,相当于挖掉这块添加一个长$d$的空段(使得两边互不影响),那么你不能选到空段上,于是$g_{n,i,j}=f_{n-D,i-1}-\sum_{k\in [i,i+D-1]} g_{n-D,i-1,k}$.

这可以看成卷积:$G_{n,i}(x)=\sum_j x^j g_{n,i,j}$,则$G_{n,i}=x^Df_{n-D,i-1}-G_{n-D,i-1}*1$

后面的减法当然可以看成卷常函数,于是现在卷他,但问题是现在每层多项式长度都是$O(n)$爆炸,需要注意到多项式$G_i$的前$iD$项和后$iD$项对称,中间项全相等,利用这个再分治就行了.