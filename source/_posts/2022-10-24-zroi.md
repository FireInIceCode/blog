---
title: ZROI
subtitle: zrz倒立讲课,倒过来还是zrz
layout: post
show: true
istop: false
password: zrzzrzzrzzrz
tags: 
- 日志

cover: /img/2022-10-24-20-18-14-image.png
---

# Day9

## 22冲刺day9-逆序对

这就是JOI冒泡排序或LOJ花火点弱化啊?

ZR退钱///fn

## 22冲刺day9-排序

> 给一个序列$a_n$,每次可以选择相邻三个,把第一个插入到最后一个位置($a_i,a_{i+1},a_{i+2}\to a_{i+1},a_{i+2},a_i),求不超过$n^2$次将序列排序的方案数.
> 
> $n\le 1000$

想一想$n^2$排序有啥算法,直接一个选择排序(每次选择最大值,把它用操作移动到最后)拍上去就行了.最后可能会剩下两个没法用操作移动,那么在无重复元素的情况下就死了,因为操作不改变逆序对奇偶性.

如果有相同元素,那就直接有解了,因为我们改变两个相同元素的顺序就必然有解.

交,为啥FST20分啊?又是$n^2$的操作开$n$的数组///fn///fn///fn

## 22冲刺day9-旅行

> 给定数组$c$,求所有重排方案中,每个方案的权值和,一个位置的权值和定义为,最小的$i$满足从$i$开始走一圈,除了一开始在$i$的时候走过的元素之和都大于0.
> $n\le 20$

有点类似Raney的考虑,如果和小于0直接寄,否则一定是选择了第一个最小值开始走.

于是枚举最小值左右都放了哪些$c$,也就确定了最小值的位置,那么接下来要求右边前缀和大于0,左边前缀和大于$\sum c_i$,直接$dp_S$表示选了$S$内的点的方案数就行了.复杂度$n2^n$

## 22冲刺day9-计数

> 求有多少长为$n$,任意两个相邻数和不为$m$或$m+1$的方案数.
> 
> $n\le 10^9$,$m\le 10^7$,膜$10^9+7$

qyc场切题.15k.

考虑和为$m$和$m+1$的数,可以连出$m \to 1\to m-1\to 2\to m-2\to 3\ldots$,行成一条长$m$的链,要求链上不相邻的两点在位置上不相邻,以及后面大于$m$的部分点随便排.

于是考虑容斥,钦定我们连出若干条边行成若干条链,那么每条链有一种(长度为1)或两种(长度大于1)方案,问题变成了要求把$m$个元素划分成$i$个链,剩下随便放的方案数(把链看成元素做排列),方案数为
$$
\sum_{i\in [0,m]} f_{m,i} (i+n-m)!(-1)^{m-i}
$$

$f_{i,j}$表示$i$个元素划分$j$个链的方案数.

dp计算$f$可以做到$m^2$,然后剩下的部分趋近于玄学,官方题解猜测在$n-m$一定时答案是关于$m$的整式递推并且整式的次数和递推的阶数都很小,直接暴力计算前几项然后解方程(高消)发现满足一个递推式,做到$O(m)$.

另一个方法是在dp那一步写成生成函数用ODE自动机跑///xia

# Day1

## 22冲刺day1-匹配

> 给定$n$个区间$[l_i,r_i]$,两个区间之间的贡献是$\max \vert a-b\vert ,\ s.t.\ a\in [l_i,r_i],b\in [a_j,r_j]$,求把区间两两配对,最大化贡献和.
> 
> $n\le 10^6,l_i,r_i\le 10^9$

[conclusion] $\vert x-y\vert =\max x-y,y-x$
[think] **见到绝对值想拆贡献!**

于是都拆了,因为$r_i\ge l_i$,所以两个区间$i,j$的贡献一定是$\vert r_i-l_j\vert$,拆了贡献之后每个区间会贡献$r_i$或$-l_i$,于是用类似反悔贪心的思想先全设贡献$r_i$然后再贡献最小的$n/2$个$l_i_r_i$即可.

## 22冲刺day1-狼人

> 给定一个$n$个点的树,点有颜色$c_i$,求有多少个连通块有绝对众数,绝对众数指出现次数大于一半的数.
> $n\le 3000,c_i\le n$,膜998244353

考虑一个连通块显然最多被一个颜色贡献.那么对每个颜色计算连通块个数.

把当前颜色看成1,其他颜色看成-1,则相当于求有多少个和大于0的连通块,这个问题直接dp,设$f_{u,s}$表示$u$为根,和为$s$的连通块个数,转移是树上背包,于是这个可以用树上背包那个优化,子树大小为$a$的只保留$\pm siz$的,可以把树上背包优化到$n^2$,但总复杂度是$n^3$.

不会了,看题解,思路完全一样,除了说复杂度是$n^2$的.

咋回事呢?实际上每个节点的状态数是$\min (siz,cnt)$,并且$\sum cnt=n$,考虑多叉树转二叉树简化分析,那么于是对于一个$k=cnt$,考虑其所有极小的$siz$大于$2k$的点(自己的两个儿子大小都小于$2k$),那么这样的节点只有$\dfrac{n}{2k}$个,每个节点内部代价可以视为$k^2$,且其儿子中至少有一个$siz$大于$k$,于是复杂度成了$\dfrac{n}{2k}\times k^2+{\dfrac{n}{2k}}k^2=nk$,然后因为总和是$n$所以复杂度是$n^2$.


## 22冲刺day1-旅行
## 22冲刺day1-密码