---
title: ZROI省选集训
subtitle: zrz倒立讲课, 倒过来还是zrz
layout: post
show: true
top: false
password: zrzzrzzrzzrz
tags: 
- 日志

cover: /img/2022-10-24-20-18-14-image. png
---

# 2021省队集训

## Day1

### A. 数排列

> 给定$n$,和排列$x_m$,求有多少个排列$a_n$满足$x$为$a$字典序最小的长$m$的子序列.
> 膜$998244353$
> $m\le n\le 2.5\times 10^5$

开门降智

考虑$x$为字典序最小的子序列的条件.

容易发现,如果某个位置存在$x_i\le x_{i-1}$,那么可以选择$x_{1\ldots i-2},x_{i\ldots m}$以及再往后一个,这种情况不行当且仅当剩下的位置不够多,也就是$x_i$的位置后面恰好全是$x_i$往后的部分.

于是我们只需要解决对于一个递增的$x$的问题去凑组合数,考虑把$x$放一排,从小到大插空即可.

复杂度线性.

### B. 取石子游戏

> Alice 和 Bob 在玩取石子游戏，游戏规则是这样的：游戏开始时在他们面前有若干堆石子，Alice 先手进行游戏，两人轮流操作，玩家每轮操作时可以选取一堆石子，并从中至少取走 $1$ 颗石子，可以把这堆石子取空，如果某轮中某位玩家无法进行任何操作（即所有石子均被取完了），则她或他输掉游戏，另一方赢得游戏。
> 
> Alice 和 Bob 两人都十分聪明，并且他们知道彼此均会以最优策略进行操作，所以他们可以在游戏开始前就预知游戏的赢家是谁。
> 
> Charlie 为 Alice 和 Bob 准备了一项任务：在 Alice 和 Bob 面前有 $n$ 堆石子，编号为 $1...n$，初始时第 $i$ 堆中有 $a_i$ 个石子。
> 
> Charlie 会依次执行 $q$ 次操作，每次操作是以下两类之一：
> 
> 1. 格式为 `1 l r x`：对于编号在 $[l,r]$ 之间的石子堆 $i$，如果不足 $x$ 颗石子，把它补充到 $x$ 颗，否则不做变化。
> 2. 格式为 `2 l r x`：询问 Alice 和 Bob 如果此时只保留编号在 $[l,r]$ 之间的石子堆，再加入一堆新的含有 $x$ 个石子的石子堆，然后进行游戏，那么 Alice 在进行第一轮操作时有几种操作方案可以保证她的胜利，两种操作方案不同当且仅当选取了编号不同的石子堆，或选取了相同编号的石子堆但是取走了不同数量的石子。
> 
> 注意在第 $2$ 类操作中，Alice 和 Bob 并不会真的进行游戏，所以也不会对石子堆有任何改变。
> 
> Alice 和 Bob 虽然回答了询问，但是 Charlie 不相信他们的答案。请你编写程序计算每次游戏时 Alice 在第一轮中的可行操作数。
> 
> $n,q\le 2\times 10^5$

感觉较简单.

先考虑查询,考虑求有多少种走完先手必败,也就是异或和为$x$,那么求出当前区间异或和$s$,就是有多少个数$a$使得$a^(a-i)=(s^x)$,也就是$a^(s^x)<a$,发现这个等价于$a$在$s^x$的最高位上为1.

瞪着那个修改,显然有个均摊:区间内值的个数是递减的,可以用Segment Tree Beats,如果当前区间不只有一个数就向下递归,维护区间内每个位上的$1$的个数,复杂度是$n\log n\log v$

### C. 滑冰

> 有一个 $n\times m$ 的滑冰场，其中有一些障碍物。你一开始在滑冰场的某个位置上。
> 
> 每次你可以选择上下左右四个方向之一进行移动，因为冰面很滑所以你会一直朝选定的方向移动直到碰到边界或障碍物。
> 
> 用 `.` 表示无障碍物的冰面，用 `#` 表示障碍物，用 `S` 表示你初始的位置（这个位置也是无障碍物的冰面），例如：
> 
> `.....`
> 
> `.....`
> 
> `#.S.#`
> 
> `.....`
> 
> `..#..`
> 
> 就描述了一个可能的滑冰场。将第 $i$ 行第 $j$ 列的位置记作 $(i,j)$，则你在 $(3,3)$，向上会移动到 $(1,3)$，向下会移动到 $(4,3)$，向左会移动到 $(3,2)$，向右会移动到 $(3,4)$。
> 
> 现在将一些无障碍物的冰面上放上标记点，用 `o` 表示，也就是说 `o` 表示标记点，而且这个位置也是无障碍物的冰面。
> 
> 保证你初始的位置上没有标记点。
> 
> 请问你能否规划一个移动方式，使得你的移动路线可以经过所有的标记点呢？

