---
title: 杂题(tricks)
subtitle: 零碎
layout: post
show: true
istop: false
tags: 
- 日志
- 杂题

---

做题笔记

### P2150 寿司晚宴 [状态压缩] [背包]

大于 $\sqrt n$ 的质因数最多只有一个,最多出现一次,相同大质因数一起处理,背包合并

### P2048 超级钢琴 [贪心]

要求所有区间的前k大,考虑处理 $k$ 次取最大,开一个堆记录 $(l,rl,rr,t)$ 表示左端点为 $l$ ,右端点在 $rl$ 到 $rr$ 间时最优位置为 $t$ 的答案,每次从堆中取出最优解,把区间分裂成 $(l,rl,t-1)$ 和 $(l,t+1,r)$ 两个区间放回堆中

### P3783 天才黑客 [虚树] [最短路] [前缀和优化建图]

点边互换,考虑对于一个点怎么把这些边连到一起.

考虑边之间的贡献是lcp,那么可以转字典树上lca,然后转字典树欧拉序最小值.

那么在这个序列上一个最小值会贡献前面一段后面一段,用前后缀优化建图.并且因为要对每个点单独跑一遍所以要用虚树.

最后可能会连出多余的边,但是最短路保证了只会走最小值(重边自动取min),所以是正确的.

### P1763 埃及分数 [迭代加深] [搜索]

居然是第一次写迭代加深

首先迭代加深主要是用在dfs搜索情况太多必然会挂,bfs每层情况太多存不下,此时若能确定一个状态的后继状态的一个较小的范围那么就可以用.

如果我们决定每层分母从小到大,也就是分数递减,那么重点就是看每层的上下界,设减去前面搜了的还剩 $\frac {a}{b}$ 要填,当前分母为x,后面还有 $rest$ 层:

当分母大到一定程度,即使后面的都等于自己也到不了1时显然是不行的,所以 $rest*\frac {1} {x} \ge \frac {a} {b}$ 

当分母小到一定程度,即使后面都是0也超了更是不行的,所以 $\frac {1} {x} \le {a} {b}$ 

最后,这题似乎并没有靠谱做法,至少在要求最大分母少于 $10^7$ 时讨论区里这组数据还杀遍程序无敌手:

```
Input:
570 877
Output:
2 7 144 15786 18417 42096
```

---

## codeforces 2200左右的trees题

### CF76A Gift [lct] [mst]

> 一张图,每条边有两个属性 $(g_i, s_i)$ .给定 $G, S$ ,求一棵图的生成树 $T$ ,使得 $G \times \max(g_i) + S \times \max (s_i)$ 最小.( $i\in T$ )
> 
> 注意:图可能包含重边和自环.
> 
> $N\le 200,M\le 50000$

考虑把所有 $G$ 和 $S$ 直接乘上去,就不用管了.问题变成 $\min \max(g_i)+\max(s_i)$

那么枚举一个最大的 $g$ ,能选的边是一个前缀,LCT!.

题解区里没有LCT?要不我去写一个?考虑一个阳间做法,这题 $N$ 只有200.///kx

### CF77C Beavermuncher-0xFF [dp]

> 给定一棵树,点 $i$ 的权值为 $k_i$ 求一条从根出发到根结束的路径使得每个点经过次数不大于其权值.最大化路径长度.
> $n,k_i\le 10^5$

$f_i$ 表示进入 $i$ 的子树走一圈回到 $i$ 的最大数量,那么求 $f_u$ 肯定是走了孩子中 $f$ 递增排休后的一个前缀.结束了.

### CF575B Bribes [ds]

> 给一棵树,一些边无方向边权为0,有向边逆向经过一次边权翻倍.求按照给定顺序经过 $k$ 个点的边权和.答案膜.
> 
> $n\le 10^5,k\le 10^6$

首先一个显然的 $2log$ 做法,就是树剖区间乘区间和.

那么正解可以对每一条边单独考虑,按某方向经过它的代价当然是有若干次子树内与子树外这个切换.

考虑切换是上一次在一个子树区间内,下一次在子树区间外的个数,那么把相邻两个数看作一个点,就转化为二维数点了,1log.

看题解,愚蠢了.直接树上差分做.

### CF893F Subtree Minimum Query [线段树合并]

> 给你一颗有根树,点有权值, $m$ 次询问,每次问你某个点的子树中距离其不超过 $k$ 的点的权值的最小值.(边权均为 $1$ ,点权有可能重复, $k$ 值每次询问有可能不同)
> 强制在线
> 
> $n\le 10^5,m\le 10^6,a_i\le 10^9$

线段树合并一眼题.

看题解,原来题目深意在于难为主席树///kx.不过可以直接考虑就是深度,dfs序两维的数点要强制在线.那显然就是时间轴建哪的问题,发现如果时间轴建在dfs序上会寄因为要考虑这个值在区间中出现次数(值有重复).但只要两维反一下就直接做.

另外给相同点权强行钦定大小整成多个也能做啊.

### CF1174F Ehab and the Big Finale [交互] [点分治] [树剖]

> 给一棵 $n$ 点树,有一个不知道的点 $x$ ,每次你可以询问 $x$ 到一个点的距离,或者询问 $x$ 的祖先的哪一个儿子是 $x$ 的祖先.找出 $x$ .
> 
> 你可以进行36次操作. $n\le 2\times 10^5$

首先显然是一个 $\log$ 的复杂度.在树上进行 $\log$ 的常见分治有点/边分治,树剖.

我们没法添加虚边,排除边分治.

发现点分治很直接,我们找到重心,如果是点的祖先就进入对应子树再找重心,否则距离可以用来判断当前点是不是祖先.就做完了.次数可能多一次随便剪一剪.

### CF652E Pursuit For Artifacts [边双] [连通性]

> 给定一张 $n$ 点 $m$ 边简单无向连通图,边权是 $0,1$ .每条边只能走一次,求是否存在 $a\to b$ 的路径边权不为0.
> 
> $n,m\le 3\times 10^5$

圆方树的重要结论是两个点间简单路径的并集是圆方树上到两个圆点路径距离为1的点.边双结论相同.所以缩点之后树上做即可.所以这题完全可以 $10^5$ 询问吧!

---

## Codeforces 好题 Div.1-1

看了上面那几个,又从后面随机了几个,没意思就换了个题单.是编号2213 Codeforces 好题 Div.1-1

尽量秒///fendou

### CF5E Bindian Signalizing [单调栈] [环转序列]

> 圆环上有 $n$ 个点,每个点有权值 $a_i$ ,求点对 $(i,j)$ 数量使得对于圆环上的两个区间 $[i,j]$ 中有至少一个满足 $\max_{k\in [i,j]} a_k\le \min{(a_i,a_j)}$
> 
> $n\le 10^6$

考虑一个点能与哪些点形成点对.

如果这个点是全局最大值,那么能与所有形成点对.否则不会有一个点同时可以与这个点在两个方向的区间上形成点对.

考虑序列上一个点与前面的点形成点对,显然维护缀max这件事只需要一个单调栈.

环上需要考虑跨过最后的贡献,很难写.最好的办法是把最大值转到最前面按序列做.

### CF8E Beads [数位dp] [dp] [枚举]

> 求所有长 $n$ 的01串 $s$ 中同时满足字典序不大于其逆序串,取反串和逆序取反串的串中按字典序排序的第 $m$ 个.
> 
> $n\le 50,m\le 10^16$

字典序不大于取反串, $s_1=0$ .

根据最后一位是0或1决定是小于逆序串还是逆序取反串.分别处理.假设现在最后一位是0,处理不大于逆序串.

可以同时两边向中间dp. $f_{i,0/1}$ 表示前 $i$ 个和后 $i$ 个已经确定,且填到现在是小于逆序串还是等于逆序串的方案数.

我们会计数了,但如何求 $kth$ 呢?

假设我们会钦定若干个字符后的方案数--我们确实会,那么可以直接逐位确定.

看题解:可以直接折半搜?!看来以后看到 $n\le 50$ 要想到这基本上是折半的上界.

### CF10E Greedy Change

> 给定 $n$ 种货币,求最小的 $w$ 使得贪心求解兑换方式不对(贪心方式就是每次找到不大于它的最大的减去),或说明不存在.
> 
> $n\le 400$

论文题///fn,汪娟题///se

todo

### CF11D A Simple Task

> 求简单无向图的环数.
> 
> $n\le 19$

降智了,这不是图论题///fn这是状压dp///fn看到19该想到的.

那就对每个点跑一遍, $f_{i,S}$ 表示从点 $u$ 出发走到点 $i$ ,走过的点集合为 $S$ ,但很遗憾会把一个环算好多次.

不对每个点跑一次了,钦定 $S$ 中走过的点最小的为出发节点(所以扩展时只能扩展比这个大的).

最后这样会把一条边算成一个环,还会把一个环算两次,所以去掉即可.

### CF13E Holes

就是弹飞绵羊

### CF15D Map

> 小P要在某个 $n\times m$ 规模的矩阵上建大小为 $a\times b$ 的房子,已知这个矩阵每一点上的数值 $h_{i,j}$ 代表开始时地面的高度.\
> 若建造 $a\times b$ 房子的地面不一致,则要把选取的 $a\times b$ 大的矩阵中所有地面都挖低使得和其中一块最低的地面高度一样,花费是挖的高度和. 小P会重复如下的步骤直至无法再建造更多的房子: 
> 1.找到 $n\times m$ 矩阵中建造房子花费最少的 $a\times b$ 矩阵,优先选择左上角的矩阵.\
> 2.输出左上角的位置,并输出在这里建房子的花费\
> 3.已经建过房子的地面不能再建房子.\
> $a,b\le 1000,h_{i,j}\le 10^9$

直接每个点预处理以这个点为左上角的代价排序.代价处理需要二维前缀和求和,和一个东西求最小值.

最小值要想求的简单,感觉一个不错的办法是先竖着求竖着 $b$ 个的最小值再横着合并 $a$ .

然后解决选的不能和已有的覆盖,这个怎么做呢?每次选定一个点就把受这个影响的地方暴力覆盖,复杂度是对的因为一共 $nm$ 个点.

### CF19E Fairy

> 给一张无向图,求删一条边变成二分图的方案数.
> 
> $n,m\le 10^4$

碰到不知道咋做的图论想dfs树.

dfs树上只有树边和返祖边,我们可以在返祖边知道是不是奇环,然后给这一段每条边奇环个数加1(用差分).然后再判断每一条边,树边判断其个数是否等于总数,非树边判断总数是否是1(最多一个奇环经过非树边).

这个做法的本质是dfs树把无向图排布成一个优秀的结构让环和一条返祖边一一对应.

### CF25E Test

> 给出 $s_1,s_2,s_3$ ,求最短的 $t$ 使得其包含给出的三个串作为子串.
> 
> $n\le 10^4$

暴力枚举三个子串出现的先后顺序,最后答案只能是它们接起来.算接起来的重叠部分可以直接kmp或hash二分.

### CF39C Moon Craters

> 给出在一个直线上的 $n$ 个圆(位置和半径为 $p_i,r_i$ ),如果两个圆不相交则可以放在一起(可以包含),求最多有多少个圆一起.
> 
> $n\le 2000$

$f_{i,j}$ 表示区间 $i,j$ 的个数做就行了.注意直接转移 $n^3$ ,但划分区间的时候可以钦定左半边是一整个圆,这样只要划分那些有一个左端点是 $i$ 的区间的右端点即可.

### CF55D Beautiful numbers

> 求 $[l,r]$ 中美丽的数的个数, $x$ 美丽当且仅当 $x$ 可以被每一个非零位整除( $15$ 是美丽的因为可被 $1,5$ 整除)
> 
> $1\le l\le r\le 9\times 10^18$

看着很数位dp.但要想判断是否能被整除需要知道数值是无法忍受的.考虑 $1-9$ 的 $lcm$ 只有 $2520$ , $2520$ 的因数(对应当前 $0-9$ 的不同选择情况)只有48个,于是就 $f_{i,j,k,0/1}$ 表示前 $i$ 位,膜 $2520$ 为 $j$ ,当前选择的数要求它被 $2520$ 的第 $k$ 个因数整除,是否顶到头的方案数.

### CF73D FreeDiv

> 给出一个 $n$ 点 $m$ 边的图和常数 $k$ ,你可以现在图中任意连边,然后在得到的图中继续连边,但此时一个点只能连出一条,同一个连通块只能连 $k$ 条,求为了得到一个连通图第一步需要连多少边.
> 
> $n,k,m\le 10^6$

一开始以为需要点分类讨论的,但这个题可以通过贪心避免讨论.

首先考虑判断继续加边前什么样子时图可以连通.实际上只要能连的边总数大于需要边数因为我们可以保证不连环.

那么边数总和是 $\dfrac{\sum \min siz_i,k}{2}$ ,需求量是连通块个数-1,所以 $siz$ 越大越好(取 $\min$ ),所以每次取两个最小的连通块合并知道满足式子即可.

### CF85D Sum of Medians

> 维护一个集合,支持添加一个数,删除一个数,或者查询对于将集合内的数从小到大排好序后形成有 $k$ 个数的序列 $a$ ,求
> 
> $$\sum_{i}^{(i\le k)\land (i\bmod 5=3)}a_i$$
> 
> $n\le 10^5,x\le 10^9$

权值线段树,维护每个点膜5余0,1,2,3,4的和即可.

### CF86D Powerful array

莫队板子.

### CF93C Azembler

爆搜idfs板子

### CF95E Lucky Country

> 如果一个数中不包含除 $4$ 和 $7$ 之外的数字则是幸运数.有 $n$ 个岛屿,通过双向道路连接.这些岛屿被分为几个地区.每个岛属于恰好一个区域,同一区域中的任何两个岛之间存在道路,不同区域的任何两个岛之间没有路径.如果一个地区的岛屿数量是一个幸运数字,则这个地区是幸运的.问最少增加几条道路能创建一个幸运地区.
> 
> $n,m\le 10^5$

处理连通块+背包,但01背包这个过不去.

考虑所有连通块大小之和为 $n$ ,那么经典套路不同的大小有 $\sqrt n$ 种,所以可以作成 $\sqrt n$ 个物品的完全背包,结束.

### CF103E Buying Sets

放到了网络流选做里.

### CF115E Linear Kindom Races

> 给定序列 $a_n$ 和 $m$ 个区间,每个区间有价值 $w_i$ ,若要得到区间 $[l,r]$ 的 $w$ 需要支付 $\sum_{l\le i\le r} a_i$ .求最大收益(收入-支出)
> 
> $n,m\le 2\times 10^5$

这是dp题.

很自然的想法是 $f_i$ 表示前 $i$ 个的最大收益, $i$ 如果不修复直接从上一个整过来,否则 $f_i$ 可能一直修复一个区间到 $f_j$ ,我们钦定没有跨过区间 $[j,i]$ 的端点,然后贡献就是完整包含在 $[j,i]$ 的区间的 $\sum w_k$ 减去 $\sum a_l$ ,考虑优化.

用线段树维护它,线段树上每个位置放的就是完整包含在这一段的贡献,那么就每个下标 $i$ 维护这个决策的值就行了.

### CF132E Bits of merry old England

放到网络流选做里.

### CF164C Machine Programming

放到网络流选座里

### CF176E Archaeology

就是 异象石.

### CF200A Cinema

> 给出 $n\times m$ 的01矩阵 $A$ ,每个元素初值为 $0$ , $k$ 次操作,每次给出 $x,y$ ,求离其曼哈顿距离最近的 $0$ 并将其设置为1.
> 
> $n,m\le 2000,k\le \min(nm,10^5)$

KDT?///kx

最无脑的一定是拆开曼哈顿距离,四个方向各放一个树套树了吧,可以直接冲.

代码阳间的是,考虑因为只有 $k$ 个 $1$ ,所以一个 $0$ 距离最近的 $1$ 不超过 $\sqrt k$ ,于是维护每个点离它最近的距离,然后查的时候暴力枚举等于这个距离的一圈有没有即可.因为你询问的 $q$ 个点的最近距离的总和是 $\sqrt k$ 的.就做完了啊.

### CF204D Little Elephant and Retro Strings

> 给定字符串 $s$ ,字符为 $\texttt{01?}$ , $\texttt{?}$ 表示任意.求多少种方案满足存在两个不相交子串(严格),且左边的全 $\texttt{1}$ ,右边的全 $\texttt{0}$ .
> 
> $k\le \vert s\vert \le 10^6$

统计问题,设 $f_i,g_i,h_i$ 分别表示前 $i$ 个的最后 $k$ 个全 $\texttt{0}$ ,后 $i$ 个前 $k$ 个全 $\texttt{0}$ ,后 $i$ 个出现过 $\texttt{0}$ 段,然后方案数就是 $\sum f_ih_{i+1}$

就是要这种可以在多个地方贡献的问题钦定在第一处/最后一处等特殊位置.

### CF235C Cyclical Quest

收录在字符串选做上


### CF254D Rats

> 一个 $n*m$ 的网格图中,有一些格子是墙,用 $X$ 表示,其余格子中,有一些格子中有**老鼠**,用 $R$ 表示,其余空格子用 $.$ 表示
> 
> 现在需要放置两颗**手榴弹**,每颗手榴弹初始在格子 $(r_i,c_i)$ 上,在 $1-d$ 秒内,每过 $1$ 秒其伤害范围会从现有的每个伤害范围的格子向外扩展一格,即若 $(a,b)$ 为伤害范围,则下一秒 $(a+1,b),(a-1,b),(a,b+1),(a,b-1)$ 中不为墙的格子都会变为伤害范围,当一个有老鼠的格子成为伤害范围,那个格子的老鼠就会死掉
> 
> 你需要给出能够杀死所有老鼠的两个手榴弹的放置坐标 $(r_1,c_1)和(r_2,c_2)$ ,如果无解,则输出 $-1$
> $n,m,d$ 为常数, $n,m\le 1000,d\le 8$

疯狂bfs,先随便找一只老鼠bfs能炸到它的地方,在这个区域枚举第一个炸弹的位置,找到一只第一个炸弹炸不到的老鼠,在这里枚举第二个炸弹的位置,复杂度 $d^8$

### CF263E Rhombus

> $n\times m$ 的矩阵 $a$
> 
> 函数 $f(x,y)=\sum_{i=1}^n\sum_{j=1}^m a_{i,j} \times max(0,k-\vert i-x\vert -\vert j-y\vert )$ ,求 $(a,b)$ 最大化 $f(a,b)$ ,其中 $a\in [k,n-k+1],b\in [k,m-k+1]$
> $n,m\le 1000$

todo

## qyc推荐

### [2022SDFZ省选模拟赛6]词典 [闵可夫斯基和] [决策单调性] [dp]

> 一个 $01$ 串 $s$ 是**单词**当且仅当 $s$ 中不含两个连续的 $0$ .
> 
> 一个包含 $n$ 个单词的**词典**是 $n$ 个单词的集合,且满足其中任意一个单词都不是任意其他单词的前缀.
> 
> 给定一个词典 $D$ ,定义 $01$ 串 $s$ 的代价 $C(s)=\displaystyle \sum^{k}_{j=1}\lfloor 1+\log_2 j\rfloor$ ,其中 $k$ 是 $D$ 中满足 $s$ 是 $t$ 的前缀的单词 $t$ 的数量.该词典 $D$ 的代价即为所有 $01$ 串的代价之和.
> 
> 例如,考虑一个包含 4 个单词的词典 $\{0,10,110,111\}$ .这个词典的代价为 $C(\epsilon)+C(0)+C(1)+C(10)+C(11)+C(110)+C(111)=8+1+5+1+3+1+1=20$ .这里 $\epsilon$ 表示空串.
> 
> 求包含 $n$ 个单词的词典的代价的最小值.
> 
> 多组询问, $n\le 10^15,t\le 50000$

神仙题.

考虑把字典插入到一个trie里,那么因为没有互为前缀所以所有单词叶子,因为没有两个连续 $0$ 所以左儿子没有左儿子,树的结构就是

![picture 2](/img/2022-10-19-21-07-53-image.png)

于是考虑dp,设 $f_{i}$ 表示 $i$ 个叶子的最小代价,设题面里的代价函数为 $g(k)$ 则有 $f_{i}=g(i)+g(j)+f_j+f_{i-j}$ .这里 $j$ 是枚举 $b$ 的子树大小,那么发现 $v$ 的代价是 $g(j)$ , $u$ 的代价是 $g(i)$ .如果你不明白为什么是 $g(i)$ 你就再想想.

然后猜测 $g$ 和 $f$ 都是上凸的,用闵和优化(闵和带来的决策单调性,两个函数归并每次向后延一段)可以做到 $O(n)$ .再考虑发现因为 $g$ 的差分只有 $\log$ 段, $f$ 的差分只有 $\log^2$ 段,所以每次向后延伸一段差分相同的部分,复杂度就成了 $\log^2$ 的了.

然后最后实际上它是差一点上凸的,仅在 $n=5$ 的时候会算错,需要特判.

### UOJ182. [UR #12]a^-1 + b problem

> 区间加,区间和,区间取逆元
> 
> $n\le 10^5,m\le 6\times 10^4$ ,膜998244353

每个数可以写成 $\dfrac{ax+b}{cx+d}$ ,把 $c$ 化成1,写成 $a+(b-ad)\dfrac{1}{x+d}$ ,前面的提出来是常量,所以最后多点求值.

### P8371 [POI2001]绿色游戏

> 绿色游戏是一种两人游戏,双方分别称 $\text{Ann}$ 和 $\text{Billy}$ .游戏的内容主要是轮流在棋盘上移动一颗棋子.
> 
> 棋盘上的点一部分是绿色的,其余是白色的.它们全部从 $1$ 至 $a+b$ 编号.编号 $1$ 至 $a$ 的点属于 $\text{Ann}$ ,编号 $a+1$ 至 $a+b$ 的点属于 $\text{Billy}$ .每个点都有一些后继点,均可一步到达.属于 $\text{Ann}$ 的点的后继点一定属于 $\text{Billy}$ ,反之亦然.所有的点都至少有一个后继点,这样总可以往下走一步.
> 
> 游戏开始时把棋子放在任意的一点 $P$ 上,然后双方轮流移动棋子至当前所在点(属于移动方)的一个后继点上(属于对手).游戏由点 $P$ 的拥有者开始,结束时棋子第二次到达了某一点,称点 $Q$ .如果在从点 $Q$ 至点 $Q$ 的一连串移动中,棋子至少一次被放到绿色点上,则 $\text{Ann}$ 赢.若从点 $P$ 开始,不管 $\text{Billy}$ 如何移动, $\text{Ann}$ 总能保证赢得这次游戏,则称 $\text{Ann}$ 对起始点 $P$ 有必胜的策略.
> 
> 请你编写一个程序:
>  
> 1. 读入对棋盘的描述.
> 
> 2. 算出 $\text{Ann}$ 有必胜策略的起始点.
> 
> $a,b\le 3000$ ,边数 $30000$ ,绿点个数 $green\le 100$

qyc推荐的题.

考虑路径上所有经过的点中,只让走了两次的那个绿点贡献(必然存在的),那么如果一个绿点出发有必到达自己策略它是必胜的,否则就不用管.而只要从必胜绿点走出去dp就行了.于是把所有绿点都当必胜的去dp,每次dp出一个会输的绿点就把它从必胜绿点踢出去接着做,复杂度是 $green\times m$ .

这么做最后被踢出去的当然真的不能胜利,而胜利的确实可以走到环上,所以正确.

[think] POI最爱的钦点-调整法.

## from dwt blog

### AGC052B Tree Edges XOR

> 给定 $Tree(n)$ ,保证 $n$ 是奇数,边有边权 $w_{i,1}$ ,现在你可以任意次把与一个边相连的其他边的权值异或上这条边的权值,求是否可以让每条边的边权变为 $w_{i,2}$ .
> 
> $n\le 10^5,w\le 2^30$

最困难的一步在第一步吧.考虑这个操作本质上在干什么,发现让边权等于连到它上的两个点权的异或,则这是在交换相邻两点的点权.

[think] 重新赋值出性质.
[think] 考虑操作本质.

于是现在要给初始状态和结束状态分配点权使得权值集合相同.考虑点权其实只要确定一个点,剩下的点权都是确定的这个点异或上一个定值,于是分别确定1号点权值,然后解异或方程即可.

### ARC126D Pure Straight

> 给定 $a_n$ , $a_i\in [1,k]$ ,每次可以交换相邻两个,求最少次数使得 $a$ 包含子区间值恰为 $1,2,3,\ldots,k$ (排好序).
> 
> $n\le 200,k\le 16$

$k$ 很小,说明很状压.

于是想到设 $f_{i,S}$ 表示前 $i$ 个,最后 $\vert S \vert$ 个已经是排好序的 $S$ 的最小代价.

对于一个元素,它如果在最终集合里就移动到 $S$ 对应位置,否则应该整个移动过 $S$ 前面.

发现是错误的--这个元素除了往前移动到 $S$ 前,还可以向后移动出 $S$ .于是取个min即可.

