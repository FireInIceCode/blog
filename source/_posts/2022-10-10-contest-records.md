---
title: 比赛记录
subtitle: 挂分记录
layout: post
show: true
istop: false
tags: 
- 杂项
- 日志
- 咕咕
---

# 比赛记录

## ZSContest

很久以前写下zscontest的编号...zs是什么啊?

是不是振声啊

### A [博弈论] [打表]

> $n\times m$ 的网格上有若干硬币,初始时全部为反, $q$ 次翻转一个矩形并询问,若两人轮流操作,每次先选择一枚正面硬币 $(x,y)$ ,再选择一个 $(a,y),a<x$ 或 $(x,b),b<y$ ,同时翻转这两个格子的硬币,不能操作的人输,是先手必胜还是后手必胜.
> 
> $n,m\le 10^9,q\le 10^5$ 

首先结论:每一枚硬币是独立的.这个操作实际上相当于硬币可以向左或向下移动若干步,两枚硬币碰到一起就一起消失,那么考虑假设硬币不会消失的情况和这个是等价的,因为若选择移动多枚硬币位置相同,后手仍然以相同方式移动这个位置到先手移动到的位置是不会让局面更优也不会更劣等,所以是等价的.

于是每一枚硬币分别的SG值求出来异或,打表SG值和其矩形前缀和找规律吧.

### B [复杂度]

> 有 $n$ 个数对 $(a,b)$ 构成的集合,给定 $m$ , $k$ 和集合,求最小的 $t$ 满足有至少 $k$ 个不同子集的 $\sum a+bt\ge m$ .
> 
> $n,k\le 10^5,a,b,m\le 10^9$ 

二分答案是容易想到的,于是变成了求有多少个子集和大于 $m$ 或子集和的第 $k$ 大.

一般rank总是比kth容易,发现k并不到 $2^n-1$ ,我们的复杂度一定是相关 $k$ 的,然后就不会了.

一个我没见过的经典题求所有子集合的第 $k$ 大,解法是爆搜子集,当前结果大于等于 $m$ 就返回,否则把个数加一继续搜.

这个复杂度的分析是重点,qyc一开始说因为每次递归让方案数变大1,最多到 $k$ (不然直接停),于是就解决了,但实际上,若初始状态为全部不选,连续若干个不选并不会增加方案数,正确的做法是先递增排序,这样如果前面的不选后面的更选不了可以直接跳,就仍然有每次递归方案数变大1了.

然而这个题还有负数,考虑我们搜大于等于 $m$ 的子集,就要满足:

- 一旦和低于 $m$ 就能退出

- 若这个不选以后的也不能选

所以初始状态为选所有正数不选所有负数,并按绝对值排序,这样做保证如果当前这一位相比初始状态不能改变以后的也不行可以直接跳.

### C [直径]

> 单点修改边权,查子树直径. $n\le 10^5$ .

合并直径是简单的,四个端点两两比一比就好了,因为要查距离并支持修改所以用BIT维护点到根距离,并用建在欧拉序上的线段树维护直径解决问题.

另一种做法是静态toptree说能1log,但我还不会静态toptree,需要学习一下.

### D [FFT] [多项式]

> 给一个 $V\le 2$ 个点,识别括号和空格的自动机,字符集为 $(,),space$ ,求有多少种从点 $s$ 到点 $t$ 走 $n$ 的方案行成合法括号串. 
> 
> $n\le 10^5$ 

万恶多项式,打完 $n\le 1000$ 走人.

等学了分治FFT再来.


## 22.10.10 VP CF1198 Codeforces Round #576 (Div. 1)

和wjw,难度感觉不大到Div1.

过程大概是先切A,然后看一眼B直接SegmentTreeBeats没冲出来发现自己不会STB///fn.然后去开C,D,E,F,发现E好像可做.仔细一想是个套路网络流把它冲出来了,然后去做B写了个更简单的O(n)做法.比赛结束.

wjw切了 $B\to A\to D$

### A MP3

智障题.

### B.Welfare State

> 单点改,区间取max. $n,q\le 2\times 10^5$

写吉老师线段树的都降智.

直接离线,对每个点考虑,一个点的值是它最后一次修改的值和从这一次修改开始往后这一段时间取max的最大值.复杂度线性.

所以CF这种短时间比赛反而更不能急着码,多想想是不是可以写的简单点.

### C.Matching vs Independent Set

> 给一个 $3n$ 个点, $m$ 条边的图,你给出一个 $n$ 个点的独立集或一个 $n$ 个边的匹配.
> 
> $n\le 10^5,m\le 5\times 10^5$ .多组询问.

qyc的做法,任意求一棵dfs树,如果叶子多于 $n$ 个就选叶子,否则现在叶子少于 $n$ 个,除了叶子每个点都可以和自己的父亲/儿子匹配,于是至少有 $n$ 个边.就结束了.

wjw看了看slime的做法,说的是直接贪心求匹配(任意加边),如果够 $n$ 条直接结束,否则因为只使用了少于 $2n$ 个点,且剩下的点已经选不出相邻的两个点形成匹配,所以剩下的一起当独立集即可.

### D. Rectangle Painting 1

> 给一个 $n\times n$ 的网格图,一开始格子有黑有白,每次你可以花费 $\max w,h$ 的代价将一个 $w\times h$ 的矩形染白,求全白的最小代价.
> $n\le 50$

降智题

做法是,要么一个操作染了全局,否则必然有一个未染色的分界点(分界成左上和右下),然后可以递归下去做.这样复杂度 $n^5$ .

还是不太敢想这种 $n^5$ 复杂度的东西啊///kk,明明是可以很简单的.

### E. Rectangle Painting2

> 给一个 $n\times n$ 的网格图,一开始格子有黑有白,每次可以花费 $\min w,h$ 的代价将一个 $w\times h$ 的矩形染白,求全白的最小代价.
> 
> 黑色格子的给出方式是输入 $m$ 个矩形,黑色格子为这 $m$ 个矩形的并.
> 
> $n\le 10^9,m\le 50$ .

套路题.首先我们显然会每次将染一行或一列全染白,于是就成了选若干行和列覆盖所有位置.这个模型有点像网络流,然后发现一个最小割结束战斗(行点列点,行向列连 $inf$ ,起点,终点向行列连1).然后突然发现黑色格子是由矩形给出的.不过没关系,直接离散化, $m$ 个矩形在平面上切割刀连通块数是 $m^2$ 的,所以就是 $4m$ 个点, $m^2+2m$ 个边冲就好了.

### F. GCD Groups 2

> 给出 $n$ 个整数,要将它们划分成两个集合使得这两个集合各自 $\gcd$ 为1,求方案或判断无解.
> 
> $n\le 10^5$

有点意思.

智慧法:从前往后扫,考虑第一个集合,如果当前这个数不是 $\gcd$ 的倍数就加入这个一集合,这样 $gcd$ 一定变小.然后一遍肯定不对就randomshuffle.正确的原因是, $10^9$ 的不同质因数个数只有9, $10^9$ 到质数大约有 $5\times 10^7$ 个很多,所以很难出现一种状况让一整个集合有一个共同质因子.

官方正解(搬运翻译):

首先,你只要用 $9$ 个数干掉每一个因子.所以有解情况下必然由一种情况使得在其中一个集合大小不超过9.

然后随机取两个数钦定它们在不同的集合中,这样同一个集合的概率很小(因为其中一个集合只有9个数).然后对一个集合做状压dp(压掉当前还活着哪些质因子).这样做复杂度是 $n\times 2^{2k}$ .

最后实际不需要全部 $n$ 个数做这个dp,可以对每个素数取 $2k$ 个,这个数量可以杀掉其他所有素数,无论如何会有一个空余的可用.复杂度 $k^2\times 2^{2k}$ .

官方正解真阴,随机化万岁!.

## 22.10.12 VP CF1736 Codeforces Round #825 (Div. 2)

又是降智的一天呢!

### A.Make A Equal to B

智障题

### B.Playing with GCD

没切Div2B,输麻从此刻开始///fn///fn///fn

> 给定序列 $a_n$ ,判断是否有可能构造序列 $b_{n+1}$ 满足 $a_i=\gcd(b_i,b_{i+1})$ .
> 
> $\sum n\le 10^5$

把每一个数看作向量, $\gcd$ 是对向量每个元素取 $\min$ ,考虑如果你的向量 $b_i$ 的一个元素同时比 $a_i$ 和 $a_{i-1}$ 的对应元素大,那么一定是不优的(你不能用它做取 $\min$ 了).所以结论是 $b_i=\operatorname{a_i,a_{i-1}}$ ,然后有可能不行,所以再 check 一遍.

### C1. Good Subarrays (Easy Version)

写麻烦做法,继续寄///ll

> 给定序列 $a_n$ ,求有多少子区间 $[l,r]$ 满足 $\forall i\in [l,r],\ a_i\ge {i-l+1}$
> 
> $\sum n\le 2\times 10^5$ ,多组询问

赛时写了个,从后面往前扫,每次给当前后缀区间减1,二分第一个小于 $0$ 的位置.总结应该是,还是太着急写代码,明明想到某些单调性但觉得这个不难写就直接冲了.

考虑每个位置减去下标,问题变成 $\forall i\in [l,r]\ ,a_i\ge -l+1$ .

然后考虑每个左端点,合法的右端点是一个前缀,并且每个左端点对应的合法右端点是单增的,那么可以直接从上一个左端点的右端点开始往后扫就能处理出每个位置为左端点对应的右端点,把这个数组记为 $r$ .

不过看起来不给前后缀区间减一没有关系,重点是要发现右端点单增可以直接扫///fn

### C2. Good Subarrays (Hard Version)

接着刚才的做法,区别是加了独立的单点询问.

发现改小是直接二维数点(平面上线段,求矩形内线的总长),改大比较问号,我们根本不会追溯修改.

然后我在错误的道路上越走越远了.

然后汪娟突然跳出来:改大不是比改小简单吗?

是的!我们是智障!///fn,因为改大的时候,你只会改一个数,所以对一个 $i$ ,可以处理若 $r_i+1$ 被改对了那么新的 $r_i$ 是几,就做完了.

CF官方题解上改大和改小是同一个处理///jy厉害了

## Public NOIP Round #3 (Div. 1, 提高)

### A. 移除石子

> 给定平面上 $n$ 个点,构造选择 $\dfrac{n}{2}$ 个正方形的方案使得每个正方形内恰好有两个点,且正方形覆盖了所有点.
> 
> $T\le 60,n\le 3000,x_i,y_i\le 10^9$

每个点对建一个点,然后从构成点对的两个点指向代表点对的点,遍历每个点对,如果这个点对 $u$ 组成的矩形上或内有另一个点 $v$ 则连边 $u\to v$ ,然后在图上跑拓扑排序.

不对,边数 $n^3$ ,一个矩形内可能有一摞点.

考虑从左往右扫,如果当前左边的点没法消,就把它插入到操作序列的最后,否则放在操作序列的最前面,就可以了.

提高不会A是怎么回事啊///ll

然后qyc说,汪娟看了这场说只会D,于是看D


### D. 数圈圈

> 给定一个 $n\times m$ 网格,每个位置是一个小写字母,求有多少个矩形满足边框上字母相同.
> 
> $n,m\le 2000$

直接对每个位置预处理向右向下向左向上最远到哪里,那么枚举一个左上角,就要求一个矩形内所有向左向上超过左上角坐标位置的,就直接数点了.要对每个颜色分开做即可.

诶不对,这是2log的,死了.

考虑竖着分治,画一条横线,考虑穿过它的矩形,那么现在我们可以用 $n^2$ 的时间去干一层.

我们预处理每个位置向上向下延伸多远,然后确定左边的一条竖线,向右扫描,维护当前有多少个向右的横线,在每个竖线统计答案.

对于维护横线这一步,我们先预处理出所有向右的横线,然后在一个位置加入贡献,在另一个位置删除贡献即可.

A,C todo

## CSP-S 2022

遗憾疫情把csp杀了///fn

### T1 假期计划(holiday)

> 给定 $Graph(n,m)$ ,点有点权 $w_i$ ,求 $a,b,c,d$ 满足 $1\to a\to b\to c\to d\to 1$ 这条路径中两两点距离不超过 $k$ ,且最大化 $w_a+w_b+w_c+w_d$ .
> 
> $n\le 2500,m\le 10000,k\le 100$

先 $nm$ 求一遍距离应该没什么异议.

考虑 $n^2$ ,而且只出 $a,b,c,d$ 肯定是让你枚举的,一般这种都是中间的比较重要,考虑枚举 $b,c$ ,于是现在要确定 $a,c$ ,直接对每个点 $u$ 处理 $1\to u$ 路途中点权的最大的,次大的,发现还是可能重复,那就再处理次次大的,发现肯定行了.

问号 $k\le 100$ 是干什么的?

### T2 策略游戏(game)

> 给定 $a_n,b_m$ , $q$ 次询问,每次给定参数 $l_1,r_1,l_2,r_2$ ,求A先从 $a_{ [l_1,r_1] }$ 中选一个数,B再从 $b_{ [l_2,r_2] }$ 中选一个数,A想最大化两数乘积,B想最小化,求最后乘积是多少.
> 
> $n,m,q\le 10^5$

那就是最小值的最大值,分正负数讨论,然后用随便什么RMQ做就了.

### T3 星战(galaxy)

> 给定有向图 $Graph(n,m)$ , $q$ 次操作,每次删去一个边,或恢复一条之前被删掉的边,或删掉连向一个点的所有**入**边,或恢复一个点的所有入边,或者问当前的图是不是所有点出度为 $1$ .
> 
> $n,m,q\le 5\times 10^5$

光想着对度数搞根号分治了///fn

考虑hash边集,维护全局hash值,那么处理每个点周围的hash,操作点直接做,操作边要改全局hash和连向的点的hash即可.

为什么脑子里总是没有随机化这根弦啊?

### T4 数据传输 (transmit)

> 给定 $Tree(n)$ ,点有点权 $w_i$ , $q$ 次询问对于点 $u,v$ ,选定序列 $c$ ,使得序列相邻两项距离不超过 $k$ ,序列首/末项到 $u$ / $v$ 的距离不超过 $k$ ,序列中点的权值和的最小值.
> 
> $n,q\le 2\times 10^5,k\le 3$

$k\le 3$ !!!

直接DDP $f_{u,0/1/2}$ 表示上一个点距离自己 $0/1/2$ 的情况的最小权值,这里正反是一样的,所以从 $u,v$ 分别矩阵乘到lca,然后在lca处合并.

但是当 $k=3$ 的时候,有可能选择一个不在 $u,v$ 路径上的点,但发现那样的话必然是路径上的点的儿子,所以动态dp的时候搞一下权值就行了.

### 总结

今年CSP怎么感觉是数据结构复兴啊///yw 是因为去年dp麻了吗///yw

T1中规中矩,可能和廊桥分配差不多?

T2相比去年简单,相比2020稍难

T3脑子里没有hash这根弦,大家真的好会随机化///ll

T4的ddp可能有点板?

暴力分挺足,T3想不出hash边集也有300+,感觉得分上比去年容易多了.

## ZSContest 20221105

### C0A 分开了哦算

> 给定括号序列 $s_n$ 和括号的颜色 $c_n\in \{0,1,2\}$ ,每次可一1代价翻转一个括号,颜色不能改变,求最小代价使得 $c_i\in \{0,2\}$ 和 $c_i\in \{1,2\}$ 的括号分别组成合法括号串.
> 
> $n\le 5000$

考虑一个经典结论,在插入/修改一个括号序列使其合法的时候,只把一个前缀的右括号改成左括号,一个后缀的右括号改成左括号是不劣的.证明可以考虑括号序列把`(`看作 $+1$ ,`)`看作 $-1$ 的一个折现,每次修改一个括号是给一个后缀加/减2,最后要所有位置都不低于0且最后位置等于0,那就显然了.

于是一个 $n^3$ 做法是枚举 $c_i=2$ 的括号被修改的前后缀,在确定了它之后确定另外两个就是简单的了(就是给定一个括号串,其中若干位置不能改,要求改成一个合法的,只要从前往后扫,每次如果前缀和小于0就把一个最靠前的左括号改成右括号,最后不断把最靠右的右括号改成左括号,可以开俩堆).

考虑不枚举前后缀,转而枚举 $c_i=0$ 的括号的和,这样一来另外两种括号的和同样是确定的,那么先通过操作最左,最右的括号把它的和调整对,在这个基础上,求出不断把最左边右括号变成左,最右左括号变成右,直到不能变了的情况下每个位置被弄到的次数,设为 $x,y,z$ ,模拟一遍就出每个位置当前的值,设当前位置堆三个颜色的操作次数为 $x',y',z'$ ,于是对每个位置就有了一个限制,就是 $\min(x,x')+\min(z,z')>C$ , $C$ 是确定的常数,于是把min拆开,就成了关于 $x',y',z'$ 的线性规划,合并限制后限制数量很少所以可以直接手枚顶点.

最后发现当枚举的 $c_i=0$ 的括号的和从大到小的时候,可以维护 $x,y,z$ 每次最多变化1,线段树合并限制,复杂度1log.

### C0B 自身的成功

> 给定 $n\times m$ 的01矩阵,每次可以把一个0变成1,同一行同一列的1变成0,给定两个局面问是否可以把第一个变成第二个.
> 
> $n,m\le 1000$

如果有一个0变成1,并且这个1的同行同列有1,那一定死了,于是现在没有这种情况.

如果所有的都是1变成0,最后全是0,也死了.

考虑先把所有0变成1的点了,一定不劣,然后现在要清除所有1变成0,那就找到一个可以操作的行/列(最后没有1),然后用这行/列干掉这个1即可.如果找不到就死了.

### C0C 阿克最最易

ZR题

### C0D 最成功捧杯

> 给定 $n\times m$ 矩阵,你在奇数步可以横着任意走,偶数步可以竖着任意走,每个位置有颜色 $a_{i,j}$ ,求走 $k$ 步形成的颜色序列个数.
> 
> $n,m\le 10,k\le 600,a_{i,j}\in [1,9]$

考虑dpofdp,那么考虑给定一个颜色序列如何dp判断可行,可以 $f_{i}=S$ 表示前 $i$ 位走完可能走到的点是集合 $S$ .但这个内层状态过大:可能有一种颜色出现次数很大,所以考虑做到 $n,m$ 相关:每一次对于一行/一列,有多个颜色和有一个是一样的,只要记录 $f_{i}=S$ 表示前 $i$ 个走完之后可以走的行/列的集合是 $S$ 即可,此时内层状态数是 $k(2^n+2^m)$ .

然后考虑dpofdp,扫掉一维 $i$ 后外层dp的状态是内层的值 $S$ ,于是 $f_{i,S,j}$ 表示颜色序列前 $i$ 个,走到的集合是 $S$ ,最后一个位置颜色是 $j$ 即可,预处理转移,dp复杂度是 $(2^n+2^m)k\Sigma$ .

## ZSContest 20221116 on Vjudge

赛时会3个,T4没longlong半天没查出来///fn

### abc259h

> 给定 $n\times n$ 矩形,每个位置有值 $a_i$ ,只能往下或往右走,问有多少起点终点值相同的格路径.
> 
> $n\le 400$

这里用 $n$ 表示题目中的 $n^2$

考虑两个很显然的暴力:
- 枚举颜色 $c$ , $f_{i,j}$ 表示以颜色 $c$ 开头走到 $i,j$ 的方案数dp.
- 枚举颜色 $c$ ,枚举 $c$ 中的两个位置,以这两个位置为起点,终点的路径是一个简单组合数.

于是根号分治,出现次数大于 $\sqrt n$ 的用第一种,出现次数小于 $\sqrt n$ 的用第二种.第一部分复杂度显然 $n\sqrt n$ ,第二部分是

$$
\begin{array}{c}
    \max \sum {a_i}^2\\
    s.t.
    \sum a_i=n
    \\ a_i\le \sqrt n
\end{array}
$$

这个式子量级是经典的 $n \sqrt n$

[think] 经典复杂度分析!在做完SDOI2022D1T1后你又差点忘了.

### abc264h

> 给定 $T=Tree(n)$ ,对每个 $k$ 求只保留编号不超过 $k$ 的点的情况下 $T$ 有多少个导出子图是满二叉树(每个点有两个儿子,所有叶子深度相同).保证父亲编号小于儿子.
> 
> $n\le 3\times 10^5$

重点是,因为是满二叉树,所以二叉树深度只有 $\log n$ 量级.

于是直接dp, $f_{i,j}$ 表示点 $i$ 的子树内选深度 $j$ 的二叉树,那么转移是简单的.然后因为保证父亲编号小于儿子所以就算不断挂叶子,因为只有深度在 $\log n$ 以内的节点可能对根的dp值有贡献所以每次暴力往上跳更新就是对的.

### abc255g

> $n$ 堆石子的nim游戏,有 $m$ 个限制,第 $i$ 个限制 $x_i,y_i$ 表示若一个石子堆剩余石子为 $x_i$ ,你就不能从其中拿走 $y_i$ 个.问先手必胜/必负.
> 
> $n,m\le 2\times 10^5,a_i\le 10^{18}$

公平组合游戏,只需要考虑求一个石子堆的 SG 值,最后异或起来判断即可.

没有限制的时候显然是 $SG(x)=x$ ,那么加上限制之后会有若干个特殊点和若干段 $y=x+k$ 的一次函数.没有限制的点的值显然是前面的最大值加1,而有限制的点可以考虑维护每个 $SG(x)$ 的出现次数,不断删掉被禁止的 $x$ ,找到最小的删没了的 $SG(x)$ 就是当前的SG值.

但是直接维护 $SG(x)$ 会爆炸,但发现只维护特殊点的就行,其他的位置的次数就是一个默认的 $1$ .

### abc264g

> 有 $n$ 个字符串,每个字符串 $t_i$ 长度不超过 $3$ 且有权值 $p_i$ ,一个字符串 $s$ 的总权值为 $\sum_{i=1}^n cnt(s,t_i)\times p_i$ ,其中 $cnt(a,b)$ 表示 $b$ 在 $a$ 中出现的次数.问长度任意的 $s$ 的权值是多少,若可以无穷大输出 $\texttt{Infinity}$ .
> 
> $n\le 18278,\vert w_i\vert \le 10^9$

第一感觉是很离谱,尤其是长度不限,并且不会处理各个 $t$ 之间拼接之后包含的新的 $t$ .

这个长度3很特点,发现如果长度2可以直接每个字母建一个点,然后弄一下边权,那么现在考虑直接建点 $(a,b)$ 表示当前字母是 $b$ ,上一个字母是 $a$ ,权值就又可以用点之间的边表示了.

注意起点终点和长度为1,2的字符串的细节.